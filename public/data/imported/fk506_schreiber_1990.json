{
    "$schema": "../schema.json",
    "meta": {
        "id": "fk506-schreiber-1990",
        "molecule_name": "FK506",
        "class": "Natural Product",
        "author": "Schreiber",
        "year": 1990
    },
    "sequence": [
        {
            "step_id": "1",
            "reaction_type": "Noyori Asymmetric Hydrogenation",
            "reagents": "Ru2Cl4((S)-Binap)2, H2",
            "reagent_smiles": "CCN(CC)CC",
            "conditions": "",
            "yield": "90%",
            "reactant_smiles": "COC(=O)CC(=O)CCO[PMB]",
            "product_smiles": "COC(=O)C[C@H](O)CCO[PMB]",
            "notes": "Asymmetric hydrogenation of a beta-keto ester.",
            "substeps": []
        },
        {
            "step_id": "2",
            "reaction_type": "Alpha-alkylation",
            "reagents": "LDA, allyl bromide, HMPA",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "90%",
            "reactant_smiles": "O[PMB]CC[C@@H](O)CC(=O)OC",
            "product_smiles": "C=CC[C@@H](C(=O)OC)[C@@H](O)CCO[PMB]",
            "notes": "Alpha-alkylation of an ester with allyl bromide via enolate formation.",
            "substeps": []
        },
        {
            "step_id": "3",
            "reaction_type": "Ester Reduction",
            "reagents": "LiAlH4",
            "reagent_smiles": "[AlH4]",
            "conditions": "",
            "yield": "90%",
            "reactant_smiles": "C=CC[C@@H]([C@H](O)CC[OPMB])[CO2Me]",
            "product_smiles": "C=CC[C@@H](CO)[C@H](O)CC[OPMB]",
            "notes": "Methyl ester reduced to a primary alcohol using lithium aluminum hydride. Stereochemistry at both chiral centers is preserved.",
            "substeps": []
        },
        {
            "step_id": "4",
            "reaction_type": "Acetal Formation",
            "reagents": "DDQ",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "87%",
            "reactant_smiles": "C=C[C@@H](CO)[C@H](O)CCO[PMB]",
            "product_smiles": "C=C[C@@H](CO)[C@@H]1CCO[C@H]([PMP])O1",
            "notes": "Oxidative deprotection of a PMB ether followed by intramolecular cyclic acetal formation.",
            "substeps": []
        },
        {
            "step_id": "5",
            "reaction_type": "Iodination (Halocyclization variant likely)",
            "reagents": "NaHCO3, NIS",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "C=CC[C@@H]([C@H](CO)[C@@H]1CCOC[C@H](c2ccc(OC)cc2)O1)",
            "product_smiles": "C=C[C@H](I)[C@@H]([C@H](CO)[C@@H]1CCOC[C@H](c2ccc(OC)cc2)O1)",
            "notes": "Allyl group is selectively iodinated at the carbon alpha to the main chain, forming a new chiral center. The PMP protecting group and other stereocenters are retained.",
            "substeps": []
        },
        {
            "step_id": "6",
            "reaction_type": "Acetal reduction/cleavage",
            "reagents": "DIBAL-H",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "62% (2 steps)",
            "reactant_smiles": "I[C@H](C=C)[C@H](CO)[C@H]1CCO[C@H]([PMP])O1",
            "product_smiles": "I[C@H](C=C)[C@H](CO)[C@H](CH2CHO)O[C@H]([PMP])",
            "notes": "Acetal opening via DIBAL-H, converting a PMP-acetal into an O-PMP ether and an aldehyde. The 'PMB' label in the product structure on the screenshot refers to p-methoxyphenyl, consistent with the PMP group in the reactant. For consistency and to match the structure, [PMP] (p-methoxyphenyl) abbreviation is used for both reactant and product, even though the product label is 'PMB' in the screenshot and standard [PMB] means p-methoxybenzyl.",
            "substeps": []
        },
        {
            "step_id": "7",
            "reaction_type": "Swern oxidation / Cyclization",
            "reagents": "(COCl)2, Et3N, DMSO",
            "reagent_smiles": "",
            "conditions": "CH2Cl2",
            "yield": "94%",
            "reactant_smiles": "O=CC[C@@H](O[PMB])[C@H](CO)[C@H](I)C=C",
            "product_smiles": "O=CC[C@@H](O[PMB])[C@H]1C[C@H](CI)OC1",
            "notes": "Intramolecular cyclization where the primary alcohol attacks the alkene to form a tetrahydrofuran ring, with iodide migration, under Swern oxidation conditions. The PMB ether and aldehyde functionalities are retained.",
            "substeps": []
        },
        {
            "step_id": "8",
            "reaction_type": "Allylation",
            "reagents": "BF3·OEt2",
            "reagent_smiles": "C/C([3H])=C\\C[Sn](c1ccccc1)(c1ccccc1)c1ccccc1",
            "conditions": "CH2Cl2",
            "yield": "68%",
            "reactant_smiles": "[PMB]O[C@@H](CC=O)[C@@H]1OC[C@H](CH2I)C[C@@H]1",
            "product_smiles": "C=C[C@H](C)[C@H](O)CC[C@@H](O[PMB])[C@@H]1OC[C@H](CH2I)C[C@@H]1",
            "notes": "Lewis acid-mediated allylation of an aldehyde with an allylstannane with allylic rearrangement, forming two new chiral centers.",
            "substeps": []
        },
        {
            "step_id": "9",
            "reaction_type": "Protection",
            "reagents": "TIPSOTf",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "C=C[C@H](C)[C@H](C[C@@H]([C@@H]1C[C@@H](CI)OC1)O[PMB])O",
            "product_smiles": "C=C[C@H](C)[C@H](C[C@@H]([C@@H]1C[C@@H](CI)OC1)O[PMB])O[TIPS]",
            "notes": "Silyl ether formation (protection of a secondary alcohol)",
            "substeps": []
        },
        {
            "step_id": "10",
            "reaction_type": "Ozonolysis",
            "reagents": "O₃, pyridine",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "99% (2 steps)",
            "reactant_smiles": "C=C[C@H](C)[C@H]([OTIPS])C[CH2][C@@H]([PMBO])[C@@H]1C[C@@H](CI)OC1",
            "product_smiles": "O=C[C@@H](C)[C@@H]([OTIPS])C[CH2][C@@H]([PMBO])[C@@H]1C[C@@H](CI)OC1",
            "notes": "Ozonolysis of a terminal alkene to an aldehyde.",
            "substeps": []
        },
        {
            "step_id": "11",
            "reaction_type": "Addition to Aldehyde",
            "reagents": "tBuLi, MgBr2",
            "reagent_smiles": "Br/C(C)=C/[C@@H]1CC[C@@H](O[TIPS])C[C@H]1O[Me]",
            "conditions": "",
            "yield": "77%",
            "reactant_smiles": "I[CH2][C@@H]1OC[C@@H]([C@@H]1[C@@H](O[PMB])C[C@H](O[TIPS])[C@@H](C)C=O)",
            "product_smiles": "I[CH2][C@@H]1OC[C@@H]([C@@H]1[C@@H](O[PMB])C[C@H](O[TIPS])[C@H](C)[C@@H](O)/C=C(\\C)/[C@@H]2CC[C@@H](O[TIPS])C[C@H]2O[Me])",
            "notes": "Organolithium (derived from bromoalkene) adds to an aldehyde, forming a tertiary alcohol with controlled stereochemistry.",
            "substeps": [
                {
                    "step_id": "11.1",
                    "reaction_type": "Hydroboration-oxidation",
                    "reagents": "BH3-THF",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "65%",
                    "reactant_smiles": "O=C(OC)[C@H]1CC=CC[C@H]1[OMe]",
                    "product_smiles": "O=C(OC)[C@H]1CCC[C@@H](O)CC[C@H]1[OMe]",
                    "notes": "Hydroboration of a cyclohexene derivative. The double bond undergoes syn addition of H and B from the less hindered face, followed by oxidation to an anti-alcohol (relative to the other substituents).",
                    "substeps": []
                },
                {
                    "step_id": "11.2",
                    "reaction_type": "Protection (Alcohol Silylation)",
                    "reagents": "TIPSOTf",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "100%",
                    "reactant_smiles": "COC1CC([C@H](O))C[C@@H](C(=O)OC)[C@@H](OC)C1",
                    "product_smiles": "COC1CC([C@H]([OTIPS]))C[C@@H](C(=O)OC)[C@@H](OC)C1",
                    "notes": "Protection of a secondary alcohol as a triisopropylsilyl (TIPS) ether. The stereochemistry at the alcohol carbon is retained.",
                    "substeps": []
                },
                {
                    "step_id": "11.3",
                    "reaction_type": "Reduction",
                    "reagents": "LiAlH4",
                    "reagent_smiles": "[Li][AlH4]",
                    "conditions": "",
                    "yield": "87%",
                    "reactant_smiles": "[OTIPS][C@@H]1CC[C@H](C[C@H]1OC)C(=O)OC",
                    "product_smiles": "[OTIPS][C@@H]1CC[C@H](C[C@H]1OC)O",
                    "notes": "Reduction of a methyl ester to a primary alcohol using lithium aluminum hydride. The TIPS protecting group and methoxy group remain unaffected.",
                    "substeps": []
                },
                {
                    "step_id": "11.4",
                    "reaction_type": "Swern oxidation",
                    "reagents": "(COCl)2, Et3N, DMSO, CH2Cl2",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "O[C@H]1[C@H](OC)[C@@H](O[TIPS])CCC1",
                    "product_smiles": "O[C@H]1[C@H](OC)[C@@H](O[TIPS])CCC1",
                    "notes": "The reaction scheme indicates a Swern oxidation, which typically converts a secondary alcohol to a ketone. However, the product structure drawn in the screenshot is visually identical to the reactant, showing the alcohol unchanged. The provided product SMILES reflects this drawn structure, rather than the expected oxidized product.",
                    "substeps": []
                },
                {
                    "step_id": "11.5",
                    "reaction_type": "Gilbert-Seyferth olefination",
                    "reagents": "N2CHO(O)(OMe)2, KOTBu",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "95%",
                    "reactant_smiles": "O[C@H]1CC[C@@H]([C@H](C1)OC)[OTIPS]",
                    "product_smiles": "C#C[C@H]1CC[C@@H]([C@H](C1)OC)[OTIPS]",
                    "notes": "Conversion of a secondary alcohol to a terminal alkyne, implying an in-situ oxidation of the alcohol to an aldehyde prior to the Gilbert-Seyferth reaction.",
                    "substeps": []
                },
                {
                    "step_id": "11.6",
                    "reaction_type": "Alkylation",
                    "reagents": "nBuLi, MeI",
                    "reagent_smiles": "CCCC[Li].CI",
                    "conditions": "THF",
                    "yield": "96%",
                    "reactant_smiles": "C#C[C@@H]1[C@@H](O[TIPS])[C@H](OC)CCC1",
                    "product_smiles": "CC#C[C@@H]1[C@@H](O[TIPS])[C@H](OC)CCC1",
                    "notes": "Terminal alkyne deprotonation with nBuLi followed by methylation with MeI.",
                    "substeps": []
                },
                {
                    "step_id": "11.7",
                    "reaction_type": "Hydrozirconation / Halogenation (Bromination)",
                    "reagents": "Cp₂ZrHCl, NBS",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "86%",
                    "reactant_smiles": "CC#C[C@@H]1CC[C@@H]([C@H](C1)OC)[OTIPS]",
                    "product_smiles": "[OTIPS][C@@H]1CC[C@H](/C=C(/Br)\\C)C[C@H]1OC",
                    "notes": "Terminal alkyne is converted to an internal vinyl bromide (Z-configured) with retention of other stereocenters, except for potential changes in descriptors due to changing priorities after the transformation.",
                    "substeps": []
                }
            ]
        },
        {
            "step_id": "12",
            "reaction_type": "Esterification (amide coupling)",
            "reagents": "(S)-tBoc-N-pipecolinic acid, DCC, PPY",
            "reagent_smiles": "O=C(O)[C@H]1CCCCN1C(=O)OC(C)(C)C",
            "conditions": "",
            "yield": "81%",
            "reactant_smiles": "[TIPS]O[C@@H]1CC[C@@H](/C=C(\\C)/[C@H]([C@H](C)[C@H](C[C@@H]([C@@H]2C[C@@H](CI)OC2)[PMB]O)[TIPS]O)O)C[C@H]1OC",
            "product_smiles": "[TIPS]O[C@@H]1CC[C@@H](/C=C(\\C)/[C@H]([C@H](C)[C@H](C[C@@H]([C@@H]2C[C@@H](CI)OC2)[PMB]O)[TIPS]O)OC(=O)[C@H]4CCCCN4[Boc])C[C@H]1OC",
            "notes": "Esterification of a secondary alcohol with (S)-tBoc-N-pipecolinic acid using DCC/PPY coupling conditions.",
            "substeps": []
        },
        {
            "step_id": "13",
            "reaction_type": "Reductive allylation, PMB deprotection",
            "reagents": "Zn, NH4Cl",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "[OTIPS][C@@H]1CC[C@@H](/C=C(\\C)/[C@H]([C@H](C)[C@H](C[C@@H]([C@@H]2C[C@@H](C[I])OC2)[PMBO])[OTIPS])OC(=O)[C@@H]3CCCCN3C(=O)OC(C)(C)C)C[C@H]1OC",
            "product_smiles": "C=CC[C@H](CO)[C@H](C[C@@H]([C@@H](C)[C@@H](/C(=C/[C@@H]1CC[C@H]([C@@H](C1)OC)[OTIPS])/C)OC(=O)[C@@H]2CCCCN2C(=O)OC(C)(C)C)O",
            "notes": "Iodide is replaced by an allyl group with concurrent THF ring opening. PMB protecting group is cleaved to a hydroxyl group.",
            "substeps": []
        },
        {
            "step_id": "14",
            "reaction_type": "Swern oxidation",
            "reagents": "(COCl)2, DMSO, Et3N",
            "reagent_smiles": "",
            "conditions": "CH2Cl2",
            "yield": "96% (2 steps)",
            "reactant_smiles": "C=CC[C@H](CO)[C@H](O[PMB])C[C@@H](O[TIPS])[C@@H](C)[C@@H](OC(=O)[C@@H]1CCCCN1[Boc])[C@@H](/C(=C/[C@@H]2CC[C@H]([C@@H](C2)OC)O[TIPS])/C)",
            "product_smiles": "C=CC[C@H](C=O)[C@H](O[PMB])C[C@@H](O[TIPS])[C@@H](C)[C@@H](OC(=O)[C@@H]1CCCCN1[Boc])[C@@H](/C(=C/[C@@H]2CC[C@H]([C@@H](C2)OC)O[TIPS])/C)",
            "notes": "Primary alcohol is oxidized to an aldehyde via Swern oxidation.",
            "substeps": []
        },
        {
            "step_id": "15",
            "reaction_type": "Wittig-Horner reaction",
            "reagents": "nBuLi",
            "reagent_smiles": "S1CCCS1[C@H](C)C[C@@H]([OMe])C[C@@H]([OMe])C[C@@H]([OTBS])CCC[P](=O)(N(C)C)N(C)C",
            "conditions": "",
            "yield": "36%",
            "reactant_smiles": "O=C[C@H](C=C)C[C@@H]([PMBO])C[C@@H]([TIPS])C[C@@H](C)[C@@H](OC(=O)[C@H]1CCCCN1[Boc])C=C(C)[C@@H]2CC[C@H]([C@H](C2)[OMe])[OTIPS]",
            "product_smiles": "S1CCCS1[C@H](C)C[C@@H]([OMe])C[C@@H]([OMe])C[C@@H]([OTBS])C=C[C@H](C=C)C[C@@H]([PMBO])C[C@@H]([TIPS])C[C@@H](C)[C@@H](OC(=O)[C@H]1CCCCN1[Boc])C=C(C)[C@@H]2CC[C@H]([C@H](C2)[OMe])[OTIPS]",
            "notes": "Wittig-Horner reaction between an aldehyde and a phosphonate reagent to form an E-alkene.",
            "substeps": [
                {
                    "step_id": "15.1",
                    "reaction_type": "Selective Functionalization (Chlorination/Acylation)",
                    "reagents": "",
                    "reagent_smiles": "CC(=O)OC(C)(C)C(=O)Cl",
                    "conditions": "",
                    "yield": "90%",
                    "reactant_smiles": "OC[C@H](O)[C@@H](O)[C@H](O)CO",
                    "product_smiles": "ClC[C@H]([OAc])[C@@H](O)[C@@H]([OAc])CCl",
                    "notes": "L-Arabitol undergoes selective chlorination of primary hydroxyl groups and acylation of secondary hydroxyl groups with 2-acetoxyisobutyryl chloride. The stereochemistry at C2, C3, and C4 is retained.",
                    "substeps": []
                },
                {
                    "step_id": "15.2",
                    "reaction_type": "Double Epoxide Formation (via Intramolecular SN2) / Ester Hydrolysis",
                    "reagents": "NaOMe",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "76%",
                    "reactant_smiles": "CC(=O)O[C@@H](CCl)C([C@H](CCl)OC(=O)C)O",
                    "product_smiles": "O[C@H](C1[C@H]O1)C2[C@@H]O2",
                    "notes": "A double deprotection of acetate groups and formation of two epoxide rings via intramolecular SN2 reactions, driven by the strong base NaOMe. The central carbon with the hydroxyl group becomes chiral due to the formation of two diastereomeric epoxide groups.",
                    "substeps": []
                },
                {
                    "step_id": "15.3",
                    "reaction_type": "Protection (Silyl ether formation)",
                    "reagents": "TBSCl",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "84%",
                    "reactant_smiles": "O[C@H]([C@@H]1CO1)[C@H]2CO2",
                    "product_smiles": "[OTBS][C@H]([C@@H]1CO1)[C@H]2CO2",
                    "notes": "Formation of a TBS ether from a secondary alcohol.",
                    "substeps": []
                },
                {
                    "step_id": "15.4",
                    "reaction_type": "Double nucleophilic epoxide opening",
                    "reagents": "LiCCOEt, BF3·OEt2",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "[TBS]O[C@@H]([C@H]1CO1)[C@@H]2CO2",
                    "product_smiles": "CCOC#CC[C@@H](O)[C@H](O[TBS])[C@H](O)CC#COCC",
                    "notes": "A double nucleophilic ring opening of a bis-epoxide is performed. The nucleophile (implied 3-ethoxypropynyl lithium, from the product structure) adds to both epoxides, which are activated by boron trifluoride etherate (Lewis acid). The original epoxide oxygens are protonated to form hydroxyl groups. The OTBS protecting group remains intact. New chiral centers are formed at the carbons bearing the hydroxyl groups.",
                    "substeps": []
                },
                {
                    "step_id": "15.5",
                    "reaction_type": "Double Lactonization / Cyclization",
                    "reagents": "HgCl₂, TsOH",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "69% (2 steps)",
                    "reactant_smiles": "CCOC#CC[C@@H](O)C([OTBS])[C@H](O)CC#COCC",
                    "product_smiles": "[OTBS]C([C@H]1CCC(=O)O1)[C@@H]2CCC(=O)O2",
                    "notes": "Double intramolecular cyclization of terminal alkynes with internal diols, likely via hydroalkoxylation followed by oxidation, to form bis-gamma-lactones.",
                    "substeps": []
                },
                {
                    "step_id": "15.6",
                    "reaction_type": "Deprotection",
                    "reagents": "HF",
                    "reagent_smiles": "",
                    "conditions": "CH3CN",
                    "yield": "",
                    "reactant_smiles": "O=C1CC[C@H](O1)[C@H]([OTBS])[C@@H]2CCC(=O)O2",
                    "product_smiles": "O=C1CC[C@H](O1)[C@H](O)[C@@H]2CCC(=O)O2",
                    "notes": "Deprotection of a TBS silyl ether to a hydroxyl group using hydrofluoric acid.",
                    "substeps": []
                },
                {
                    "step_id": "15.7",
                    "reaction_type": "Benzylation",
                    "reagents": "BnOC(NH)CCl3",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "70% (2 steps)",
                    "reactant_smiles": "O=C1CC[C@H](O1)[C@H](O)[C@@H]2CCC(=O)O2",
                    "product_smiles": "O=C1CC[C@H](O1)[C@H]([OBn])[C@@H]2CCC(=O)O2",
                    "notes": "Benzylation of a secondary alcohol to form a benzyl ether.",
                    "substeps": []
                },
                {
                    "step_id": "15.8",
                    "reaction_type": "Lactone opening and O-alkylation",
                    "reagents": "NaOH, NaH, MeI",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "53%",
                    "reactant_smiles": "O=C1CC[C@@H](O1)[C@H](O[Bn])[C@H]2CCC(=O)O2",
                    "product_smiles": "COC(=O)C[C@H](C)C[C@H](OC)[C@H](O[Bn])[C@H](OC)C[C@H](C)CC(=O)OC",
                    "notes": "Base-mediated lactone opening followed by O-methylation of the resulting alcohols.",
                    "substeps": []
                },
                {
                    "step_id": "15.9",
                    "reaction_type": "Hydrogenolysis",
                    "reagents": "H₂, Pd(OH)₂",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "98%",
                    "reactant_smiles": "COC(=O)C[C@@H](C)C[C@@H](OC)[C@H]([OBn])[C@@H](OC)C[C@H](C)CC(=O)OC",
                    "product_smiles": "COC(=O)C[C@@H](C)C[C@@H](OC)[C@H](O)[C@@H](OC)C[C@H](C)CC(=O)OC",
                    "notes": "Deprotection of benzyl ether to hydroxyl group.",
                    "substeps": []
                },
                {
                    "step_id": "15.10",
                    "reaction_type": "Lactonization",
                    "reagents": "PPTS",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "63%",
                    "reactant_smiles": "COC(=O)CC[C@H](C)C[C@@H](OC)[C@H](O)[C@@H](OC)C[C@@H](C)CC(=O)OC",
                    "product_smiles": "COC(=O)CC[C@H](O)C[C@H]1O[C@](=O)[C@@H](C)C[C@@H](OC)[C@@H](OC)1",
                    "notes": "Acid-catalyzed intramolecular lactonization of a methyl ester to form a 6-membered lactone ring, with retention of a methyl ester and formation of a new hydroxyl group.",
                    "substeps": []
                },
                {
                    "step_id": "15.11",
                    "reaction_type": "Lactone reduction to hemiacetal",
                    "reagents": "L-Selectride",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "C[C@@H]1C[C@@H]([C@H]([C@H](C[C@H](CC(=O)OC)O)OC)OC1=O)",
                    "product_smiles": "C[C@@H]1C[C@@H]([C@H]([C@H](C[C@H](CC(=O)OC)O)OC)O[C@H]1O)",
                    "notes": "Reduction of the lactone carbonyl to a cyclic hemiacetal.",
                    "substeps": []
                },
                {
                    "step_id": "15.12",
                    "reaction_type": "Lactonization / Dithioacetal Formation",
                    "reagents": "BF₃·OEt₂",
                    "reagent_smiles": "HSCCC[SH]",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "CC(=O)OCC[C@H](O)C[C@H](OC)[C@H](OC)[C@H]1OC[C@@H](O)C[C@H](C)C1",
                    "product_smiles": "C[C@H]1CC(=O)O[C@H](OC)[C@H]1C[C@H](OC)[C@H](C)C2SCCS2",
                    "notes": "Intramolecular lactonization of the methyl ester, and formation of a 1,3-dithiane from the anomeric carbon of the tetrahydropyran ring.",
                    "substeps": []
                },
                {
                    "step_id": "15.13",
                    "reaction_type": "Reduction",
                    "reagents": "LiAlH4",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "93%",
                    "reactant_smiles": "C[C@H](C[C@@H]([C@H](OC)[C@H]1C[C@H](C)C(=O)O1)OC)[C@H]2SCCCS2",
                    "product_smiles": "C[C@H](C[C@@H]([C@H](OC)[C@H](O)[C@H](C)[C@H]1SCCCS1)OC)CO",
                    "notes": "Lactone reduction to a 1,3-diol using lithium aluminum hydride.",
                    "substeps": []
                },
                {
                    "step_id": "15.14",
                    "reaction_type": "Appel Reaction (Iodination)",
                    "reagents": "Ph3P, I2",
                    "reagent_smiles": "P(c1ccccc1)(c1ccccc1)c1ccccc1.I2",
                    "conditions": "",
                    "yield": "69%",
                    "reactant_smiles": "C[C@H](C[C@@H]([C@@H]([C@H](C[C@H](C)C1SCCCS1)OC)O)OC)CO",
                    "product_smiles": "C[C@@H](C[C@@H]([C@@H]([C@H](C[C@H](C)C1SCCCS1)OC)O)OC)CI",
                    "notes": "Primary alcohol is converted to an iodide with inversion of stereochemistry at the reacting carbon. Other stereocenters are retained.",
                    "substeps": []
                },
                {
                    "step_id": "15.15",
                    "reaction_type": "Alcohol Protection (Silylation)",
                    "reagents": "TBSOTf",
                    "reagent_smiles": "",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "I[CH2][C@@H](C)C[C@@H](OC)[C@@H](O)[C@H](OC)C[C@@H](C)C1SCCCS1",
                    "product_smiles": "I[CH2][C@@H](C)C[C@@H](OC)[C@@H]([OTBS])[C@H](OC)C[C@@H](C)C1SCCCS1",
                    "notes": "A secondary alcohol is protected by silylation with TBSOTf to form a TBS ether.",
                    "substeps": []
                },
                {
                    "step_id": "15.16",
                    "reaction_type": "Alkyl Halide Substitution",
                    "reagents": "",
                    "reagent_smiles": "[Li]C(C)P(=O)(N(C)C)N(C)C",
                    "conditions": "",
                    "yield": "",
                    "reactant_smiles": "I[CH2][C@@H](C)[CH2][C@H](O[Me])[C@H](O[Me])[C@H](O[TBS])[CH2][C@@H](C)[CH2]C1SCCCS1",
                    "product_smiles": "O=P(N(C)C)(N(C)C)[C@@H](C)C[C@@H](C)[CH2][C@H](O[Me])[C@H](O[Me])[C@H](O[TBS])[CH2][C@@H](C)[CH2]C1SCCCS1",
                    "notes": "Iodide is displaced by the lithium phosphonamide, forming a new C-C bond and a new chiral center. All existing stereocenters are retained, and the new stereocenter's configuration matches the depiction.",
                    "substeps": []
                }
            ]
        },
        {
            "step_id": "17",
            "reaction_type": "Oxidation",
            "reagents": "Glyoxylic acid, Acetic acid",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "59%",
            "reactant_smiles": "C=CC[C@H](C/C=C/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)CO)OC)[OTBS])OC)[C@H](CC([C@@H](C)[C@H](/C(=C/[C@@H]1CC[C@H]([C@@H](C1)OC)[TIPS])/C)OC(=O)[C@@H]([BocN])))[TIPS])[OPMB]",
            "product_smiles": "C=CC[C@H](C/C=C/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C=O)OC)[OTBS])OC)[C@H](CC([C@@H](C)[C@H](/C(=C/[C@@H]1CC[C@H]([C@@H](C1)OC)[TIPS])/C)OC(=O)[C@@H]([BocN])))[TIPS])[OPMB]",
            "notes": "Primary alcohol is oxidized to an aldehyde. Protecting groups (OTBS, TIPS, PMBO, BocN, OTIPS, OMe) and their relative positions, as well as the stereochemistry of the methyl-substituted double bonds, are maintained. The original product SMILES had significant errors, so the corrected product SMILES was derived by modifying the validated reactant SMILES.",
            "substeps": []
        },
        {
            "step_id": "18",
            "reaction_type": "Aldol-type reaction (with methyl 2-((2,4-dimethoxybenzyl)oxy)acetate)",
            "reagents": "LDA",
            "reagent_smiles": "COC1=CC=C(COCC(=O)OC)C(=C1)OC",
            "conditions": "",
            "yield": "69%",
            "reactant_smiles": "[TIPS]O[C@@H]1CC[C@@H](/C=C(\\C)/[C@H]([C@H](C)[C@H]([C@@H](C)[C@@H]([C@@H](C)/C=C(\\C)/C[C@@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C=O)[OMe])[OTBS])[OMe])O[CH2]C2=CC=C(OC)C=C2)[TIPS])[TIPS])OC(=O)[C@@H]3CCCCN3[Boc])C[C@H]1[OMe]",
            "product_smiles": "[TIPS]O[C@@H]1CC[C@@H](/C=C(\\C)/[C@H]([C@H](C)[C@H]([C@@H](C)[C@@H]([C@@H](C)/C=C(\\C)/C[C@@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)[C@@H](O)[C@H](O[CH2]C2=CC(OC)=CC(OC)=C2)C(=O)OC)[OMe])[OTBS])[OMe])O[CH2]C2=CC=C(OC)C=C2)[TIPS])[TIPS])OC(=O)[C@@H]3CCCCN3[Boc])C[C@H]1[OMe]",
            "notes": "An aldol-type addition of a protected glycine derivative to an aldehyde, forming a new C-C bond. The reaction proceeds over 3 steps.",
            "substeps": []
        },
        {
            "step_id": "19",
            "reaction_type": "Silylation",
            "reagents": "LiOH, TESOTf",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "C=CCC(/C=C(\\C)/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C(C([CO2Me])[ODMB])O)[OMe])[OTBS])[OMe])[C@H](C[C@@H]([C@@H](C)[C@@H](/C(=C/[C@@H]1CC[C@H]([C@@H](C1)[OMe])[OTIPS])/C)OC(=O)[C@H]2CCCCN2[Boc]])[OTIPS])[OPMB]",
            "product_smiles": "C=CCC(/C=C(\\C)/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C(C([CO2Me])[ODMB])[OTES])[OMe])[OTBS])[OMe])[C@H](C[C@@H]([C@@H](C)[C@@H](/C(=C/[C@@H]1CC[C@H]([C@@H](C1)[OMe])[OTIPS])/C)OC(=O)[C@H]2CCCCN2[Boc]])[OTIPS])[OPMB]",
            "notes": "A secondary alcohol is silylated to form a triethylsilyl (TES) ether. Several protecting groups were misidentified or expanded in the original SMILES and have been corrected to match the abbreviations shown in the screenshot.",
            "substeps": []
        },
        {
            "step_id": "20",
            "reaction_type": "Macrolactamization",
            "reagents": "",
            "reagent_smiles": "Cl[N+]1=CC=CC=C1.N(CC)(CC)CC",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "C=CCC(/C=C(\\C)/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C(C([CO2Me])[PMB])[OTES])[OMe])[OTBS])[OMe])[C@H](C[C@@H]([C@@H](C)[C@@H](/C(=C/[C@@H]2CC[C@H]([C@@H](C2)[OMe])[TIPS])/C)OC(=O)[C@H]3CCCCN3[Boc])[TIPS])[PMB]",
            "product_smiles": "C=CCC(/C=C(\\C)/C[C@H](C)C[C@@H]([C@H]([C@H](C[C@@H](C)C(C([PMB])C(=O)N4)[OTES])[OMe])[OTBS])[OMe])[C@H](C[C@@H]([C@@H](C)[C@@H](/C(=C/[C@@H]2CC[C@H]([C@@H](C2)[OMe])[TIPS])/C)OC(=O)[C@H]4CCCCN4)[TIPS])[PMB]",
            "notes": "Formation of a macrolactam from an acyclic methyl ester and a Boc-protected piperidine, involving Boc deprotection and cyclization.",
            "substeps": []
        },
        {
            "step_id": "22",
            "reaction_type": "Dess-Martin oxidation",
            "reagents": "DMP, CH2Cl2",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "",
            "reactant_smiles": "CO[C@H]1C[C@@H]([C@H]([C@@H](C[C@@H](C)[C@H](O)C(=O)N2CCCC[C@@H]2C(=O)O[C@@H](C=C([C@@H]3CC[C@H]([C@@H](C3)O[C@H](C)C)O[TIPS])/C)[C@H](C)[C@H](O[TIPS])[C@@H](PMBO)[C@H](C)C/C=C\\C[C@@H](C)[C@@H]1OC)O[DMB])O[TBS])OC",
            "product_smiles": "CO[C@H]1C[C@@H]([C@H]([C@@H](C[C@@H](C)C(=O)C(=O)N2CCCC[C@@H]2C(=O)O[C@@H](C=C([C@@H]3CC[C@H]([C@@H](C3)O[C@H](C)C)O[TIPS])/C)[C@H](C)[C@H](O[TIPS])[C@@H](PMBO)[C@H](C)C/C=C\\C[C@@H](C)[C@@H]1OC)O[DMB])O[TBS])OC",
            "notes": "Oxidation of a secondary alcohol to a ketone using Dess-Martin periodinane.",
            "substeps": []
        },
        {
            "step_id": "23",
            "reaction_type": "Deprotection",
            "reagents": "DDQ",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "34% (5 steps)",
            "reactant_smiles": "CC[C@H](C)[C@@H]([OMe])[C@@H]([OMe])[C@H](C)C[C@@H](C=C)[C@@H](O[PMB])[C@H](C)C[C@@H](O[TIPS])[C@H](C)C=C(C)[C@@H]1CC[C@H]([OMe])[C@@H](O[TIPS])C1)C(=O)O[C@@H]([C@H](C)N2CCCC[C@@H](C(=O)C(=O)[C@@H](O[TBS])[C@H](C)[C@H](C=C[C@@H](C)C=C(C)C2)O[DMB])C",
            "product_smiles": "CC[C@H](C)[C@@H]([OMe])[C@@H]([OMe])[C@H](C)C[C@@H](C=C)[C@@H](O)[C@H](C)C[C@@H](O[TIPS])[C@H](C)C=C(C)[C@@H]1CC[C@H]([OMe])[C@@H](O[TIPS])C1)C(=O)O[C@@H]([C@H](C)N2CCCC[C@@H](C(=O)C(=O)[C@@H](O[TBS])[C@H](C)[C@H](C=C[C@@H](C)C=C(C)C2)O)C",
            "notes": "Deprotection of PMB and DMB ethers to form corresponding hydroxyl groups.",
            "substeps": []
        },
        {
            "step_id": "24",
            "reaction_type": "Dess-Martin oxidation",
            "reagents": "DMP",
            "reagent_smiles": "",
            "conditions": "CH2Cl2",
            "yield": "84%",
            "reactant_smiles": "C[C@H]1C[C@@H](C)[C@H]([OTBS])C(OC)[C@@H](C)[C@@H](OC)[C@H](C)[C@H]([TIPS])C[C@H](C)C=C(C)CC=CC(=O)O[C@H](C(=C(C)[C@@H]2CC[C@H]([C@@H](C2)OC)[OTIPS]))C(=O)[C@H](O)C(=O)N3CCCC[C@@H]3C1=O",
            "product_smiles": "C[C@H]1C[C@@H](C)[C@H]([OTBS])C(OC)[C@@H](C)[C@@H](OC)[C@H](C)[C@H]([TIPS])C[C@H](C)C=C(C)CC=CC(=O)O[C@H](C(=C(C)[C@@H]2CC[C@H]([C@@H](C2)OC)[OTIPS]))C(=O)C(=O)N3CCCC[C@@H]3C1=O",
            "notes": "Oxidation of a secondary alcohol to an alpha-ketone using Dess-Martin periodinane.",
            "substeps": []
        },
        {
            "step_id": "25",
            "reaction_type": "Deprotection",
            "reagents": "HF",
            "reagent_smiles": "",
            "conditions": "CH3CN",
            "yield": "73%",
            "reactant_smiles": "CC[C@H]1C(=O)N(C[C@@H]2[C@H]([C@H](C)C/C=C(\\C)/C[C@H](C)C[C@@H]([C@@H]([OTBS])C[C@H](C)[C@@H](O)C[C@H](C)C(=O)C[C@H]([C@H](C)[C@H]([C@@H](O)[C@@H](C)/C=C/[C@H]3C[C@H](OC)[C@@H]([OTIPS])C3)O)[C@H]([OTIPS])C(=O)O1)[C@H](OC)C)[C@@H](OC)C)C(=O)O2",
            "product_smiles": "CC[C@H]1C(=O)N(C[C@@H]2[C@H]([C@H](C)C/C=C(\\C)/C[C@H](C)C[C@@H]([C@@H](O)C[C@H](C)[C@@H](O)C[C@H](C)C(=O)C[C@H]([C@H](C)[C@H]([C@@H](O)[C@@H](C)/C=C/[C@H]3C[C@H](OC)[C@@H](O)C3)O)[C@H](O)C(=O)O1)[C@H](OC)C)[C@@H](O)C)C(=O)O2",
            "notes": "Deprotection of silyl ethers (OTBS, TIPS) and methyl ether (C15-OMe) of a FK506 derivative to yield FK506 (Tacrolimus).",
            "substeps": []
        }
    ]
}