{
    "$schema": "../schema.json",
    "meta": {
        "id": "heterophyllisine-qin-2025",
        "molecule_name": "Heterophyllisine",
        "class": "Natural Product",
        "author": "Qin",
        "year": 2025
    },
    "sequence": [
        {
            "step_id": "1",
            "reaction_type": "Alcohol Protection (Silyl Ether Formation)",
            "reagents": "TIPSOTf, 2,6-lutidine",
            "reagent_smiles": "",
            "conditions": "CH2Cl2, rt",
            "yield": "90%",
            "reactant_smiles": "C#CCCO",
            "product_smiles": "C#CCCO[TIPS]",
            "notes": "Protection of a primary alcohol with TIPSOTf to form a TIPS silyl ether.",
            "substeps": []
        },
        {
            "step_id": "2",
            "reaction_type": "Acetylide Addition / C-C Bond Formation",
            "reagents": "n-BuLi, HCHO",
            "reagent_smiles": "",
            "conditions": "THF, -78 °C",
            "yield": "83%",
            "reactant_smiles": "[TIPS]OCCC#C",
            "product_smiles": "[TIPS]OCCC#CCO",
            "notes": "Terminal alkyne deprotonation followed by nucleophilic addition to formaldehyde to form a primary propargyl alcohol.",
            "substeps": []
        },
        {
            "step_id": "3",
            "reaction_type": "Tosylation",
            "reagents": "KOH, p-TsCl",
            "reagent_smiles": "",
            "conditions": "Et2O, 0 °C",
            "yield": "98%",
            "reactant_smiles": "[TIPS]OCCC#CCO",
            "product_smiles": "[TIPS]OCCC#CCO[OTs]",
            "notes": "Primary alcohol is converted to a tosylate ester using p-TsCl and a base.",
            "substeps": []
        },
        {
            "step_id": "4",
            "reaction_type": "Allene formation",
            "reagents": "CuCN, LiCl, MeMgCl",
            "reagent_smiles": "",
            "conditions": "THF, 0 °C to rt",
            "yield": "79%",
            "reactant_smiles": "[TIPS]OCCC#CCO[OTs]",
            "product_smiles": "C=C=C(C)CCCO[TIPS]",
            "notes": "Alkylation of propargyl tosylate derivative to form an allene.",
            "substeps": []
        },
        {
            "step_id": "5",
            "reaction_type": "Copper-catalyzed carbocyclization / hydrocyanation",
            "reagents": "CuCl catalyst (1,3-Bis(2,6-diisopropylphenyl)imidazol-2-ylidene ligand), DIBAL-H, TsCN",
            "reagent_smiles": "",
            "conditions": "THF, 60 °C",
            "yield": "94%",
            "reactant_smiles": "[TIPS]OCCC(C)=C=C",
            "product_smiles": "[C@]1(C)(C=C)[C@]2(N#C)(CO[TIPS])[C@H]3[C@]123",
            "notes": "Copper-catalyzed carbocyclization-hydrocyanation of an allene to form a bicyclo[1.1.0]butane derivative. The allene undergoes cyclization while a cyano group is introduced.",
            "substeps": []
        },
        {
            "step_id": "6",
            "reaction_type": "Deprotection",
            "reagents": "TBAF",
            "reagent_smiles": "",
            "conditions": "THF, 0 to 23 °C",
            "yield": "",
            "reactant_smiles": "C[C@]1(C#N)[C@@]2(C1)C[C@@H](C=C)[C@H](CO[OTIPS])C2",
            "product_smiles": "C[C@]1(C#N)[C@@]2(C1)C[C@@H](C=C)[C@H](CO)C2",
            "notes": "Deprotection of a TIPS ether to a primary alcohol using TBAF.",
            "substeps": []
        },
        {
            "step_id": "7",
            "reaction_type": "Oxidation",
            "reagents": "IBX, DMSO",
            "reagent_smiles": "",
            "conditions": "0 to 23 °C",
            "yield": "71% (2 steps)",
            "reactant_smiles": "C=C[C@H]1C[C@H](CO)[C@](C)(C#N)C2C1C2",
            "product_smiles": "C=C[C@H]1C[C@H](C=O)[C@](C)(C#N)C2C1C2",
            "notes": "Oxidation of primary alcohol to aldehyde using IBX.",
            "substeps": []
        },
        {
            "step_id": "8",
            "reaction_type": "Organolithium addition",
            "reagents": "NaH, n-BuLi, THF",
            "reagent_smiles": "Cc1cc(Br)c(O)c(OC)c1",
            "conditions": "0 to -40 °C",
            "yield": "75%",
            "reactant_smiles": "C[C@](C#N)1CC(CC=O)C[C@@H](C=C)C1C1",
            "product_smiles": "C[C@](C#N)1CC(C[C@@H](O)c2cc(O)c(OC)c(C)c2)C[C@@H](C=C)C1C1",
            "notes": "Formation of aryl lithium via halogen-lithium exchange followed by addition to aldehyde.",
            "substeps": []
        },
        {
            "step_id": "9",
            "reaction_type": "Oxidative Dearomatization / Cascade Cyclization",
            "reagents": "NaHCO3, PhI(OAc)2",
            "reagent_smiles": "CC(=O)O[I](OC(=O)C)c1ccccc1.[Na+].[O-]C(=O)O",
            "conditions": "MeOH, 0 to 23 °C",
            "yield": "",
            "reactant_smiles": "Cc1cc(O)c(OC)c(O)c1[C@H](O)CC[C@@]2(C=C)C1C(C)(C)[C@@H](C#N)C12",
            "product_smiles": "CC1(C)[C@H](C#N)C2C1CC[C@H](O)C3C4C(=O)C(OC)(OC)C(C5C4(C)C=C(C)C(=O)C5(OC)OC)[C@H]23C#N",
            "notes": "Oxidative dearomatization of the phenyl ring, followed by cascade cyclization to form a complex fused polycyclic system. The vinyl group is incorporated into the new ring structure. A new cyano group is formed during the reaction.",
            "substeps": []
        },
        {
            "step_id": "10",
            "reaction_type": "Thermal Fragmentation and Rearrangement",
            "reagents": "mesitylene",
            "reagent_smiles": "",
            "conditions": "170 °C",
            "yield": "",
            "reactant_smiles": "C=C[C@@](C)(CC[C@H](C12C=C(C)C(C3C1(C)C=C(C(CC[C@H](C=C)C#N)O)C(=O)C3(OC)OC)C(C2=O)(OC)OC)O)C#N",
            "product_smiles": "CC1=CC23C(CC1C(C2=O)(OC)OC)C(C)(CCC3O)C#N",
            "notes": "Complex thermal fragmentation and rearrangement of a polycyclic structure, resulting in a smaller fused system. One nitrile, one hydroxyl, one carbonyl, and two methoxy groups are lost in the transformation.",
            "substeps": []
        },
        {
            "step_id": "11",
            "reaction_type": "Oxidation",
            "reagents": "DMP, NaHCO3",
            "reagent_smiles": "",
            "conditions": "CH2Cl2, 0 to 23 °C",
            "yield": "82%",
            "reactant_smiles": "C[C@]1(C#N)CC[C@@H]2C3C1CCC(C(=O)C(OC)(OC)C=C(C)3)C2O",
            "product_smiles": "C[C@]1(C#N)CC[C@@H]2C3C1CCC(C(=O)C(OC)(OC)C=C(C)3)C2=O",
            "notes": "Oxidation of a secondary alcohol to a ketone using Dess-Martin Periodinane (DMP).",
            "substeps": []
        },
        {
            "step_id": "12",
            "reaction_type": "Ketone Reduction",
            "reagents": "NaBH(OMe)3",
            "reagent_smiles": "[Na+].[BH](OC)(OC)OC",
            "conditions": "THF, -78 °C",
            "yield": "81%",
            "reactant_smiles": "CC1(C#N)C2CCC(=O)C3C2C(C=C(C)C3)C(=O)C(OC)OC1",
            "product_smiles": "CC1(C#N)C2CCC(=O)C3C2C(C=C(C)C3)[C@@H](O)C(OC)OC1",
            "notes": "Reduction of a ketone to a secondary alcohol with specific stereochemistry.",
            "substeps": []
        },
        {
            "step_id": "13",
            "reaction_type": "O-Methylation",
            "reagents": "NaH, MeI",
            "reagent_smiles": "",
            "conditions": "THF, 0 to 40 °C",
            "yield": "83%",
            "reactant_smiles": "O=C1C(OC)(OC)C(C)=C2C[C@]3(C#N)[C@@H](C)C[C@@H](O)[C@@]123",
            "product_smiles": "O=C1C(OC)(OC)C(C)=C2C[C@]3(C#N)[C@@H](C)C[C@@H](OC)[C@@]123",
            "notes": "O-methylation of a tertiary alcohol on a bridged bicyclic system.",
            "substeps": []
        },
        {
            "step_id": "14",
            "reaction_type": "Reduction",
            "reagents": "LiAlH4",
            "reagent_smiles": "",
            "conditions": "PhMe, 110 °C",
            "yield": "",
            "reactant_smiles": "C[C@H]1CCC([C@@]2(C)C#N)[C@H]3[C@H]1[C@H](C=C(C)[C@@H]4O[C@](C3)([C@H](OC)C(=O)(OC)OC)[C@@H]24)OC",
            "product_smiles": "C[C@H]1CCC([C@@]2(C)[CH2]N)[C@H]3[C@H]1[C@H](C=C(C)[C@@H]4O[C@](C3)([C@H](OC)[C@@]4(O)(OC)[C@@H]2)OC)",
            "notes": "Reduction of nitrile to primary amine and reduction of ketone-acetal to secondary alcohol with cleavage of one methoxy group using LiAlH4.",
            "substeps": []
        },
        {
            "step_id": "15",
            "reaction_type": "Amine Protection (Boc)",
            "reagents": "NaOH, Boc2O",
            "reagent_smiles": "O=C(OC(C)(C)C)OC(=O)OC(C)(C)C.[Na]O",
            "conditions": "PhMe, rt",
            "yield": "",
            "reactant_smiles": "CC1=C(OC)[C@@H](OC)[C@](O)C2OC3C4(C)C[C@H](CN)[C@@H](C)C[C@@H]4[C@@H]3C[C@H]12",
            "product_smiles": "CC1=C(OC)[C@@H](OC)[C@](O)C2OC3C4(C)C[C@H](CN[Boc])[C@@H](C)C[C@@H]4[C@@H]3C[C@H]12",
            "notes": "The primary amine group is protected with a Boc group using di-tert-butyl dicarbonate and sodium hydroxide in toluene.",
            "substeps": []
        },
        {
            "step_id": "16",
            "reaction_type": "Oxidative Hydrolysis / Ether Cleavage",
            "reagents": "p-TsOH, MeOH, H2O",
            "reagent_smiles": "",
            "conditions": "rt",
            "yield": "86% (2 steps)",
            "reactant_smiles": "C[C@@H]1C[C@@]23[C@H](C[C@H]1[C@](O)(OC)OC)[C@@](C)(O[C@H]4C[C@@H]5[C@@H](C[C@@H]3N[Boc])[C@@]4([C@H](C)C2)C)C=C(C)C",
            "product_smiles": "C[C@@H]1C[C@@]23[C@H](C[C@H]1(O)[C@](=O))[C@@](C)(O[C@H]4C[C@@H]5[C@@H](C[C@@H]3N[Boc])[C@@]4([C@H](C)C2)C)C=C(C)C",
            "notes": "Acid-catalyzed hydrolysis of methoxy groups and oxidation of an adjacent carbon and a specific carbon.",
            "substeps": []
        },
        {
            "step_id": "17",
            "reaction_type": "Reductive Deoxygenation / Alkene Reduction",
            "reagents": "SmI2",
            "reagent_smiles": "CO",
            "conditions": "0 to 23 °C",
            "yield": "90%",
            "reactant_smiles": "CC1=C(C)C(=O)[C@H]2[C@H](O)[C@@H]3CCC4(C)OC[C@H]3C2(C)C[C@@H](CN[Boc])C4",
            "product_smiles": "C[C@H]1CC(=O)[C@H]2[C@@H]3C[C@H](CN[Boc])C4(C)OC[C@@H]3C2(C)CCC14",
            "notes": "Reductive removal of a hydroxyl group and reduction of an alpha,beta-unsaturated ketone.",
            "substeps": []
        },
        {
            "step_id": "18",
            "reaction_type": "Ozonolysis",
            "reagents": "O3, 4-methoxybenzenethiol, FeSO4",
            "reagent_smiles": "",
            "conditions": "MeOH, -78 to 23 °C",
            "yield": "",
            "reactant_smiles": "CC1CC2C(=O)C(=C)C3OC(C)(C)CC2(C)C(CN[Boc])C13",
            "product_smiles": "CC1CC2C(=O)CCC3OC(C)(C)CC2(C)C(CN[Boc])C1(C=O)C3",
            "notes": "Ozonolysis of an alkene with reductive workup to form an aldehyde.",
            "substeps": []
        },
        {
            "step_id": "19",
            "reaction_type": "Intramolecular Cyclization",
            "reagents": "TFA",
            "reagent_smiles": "",
            "conditions": "CH2Cl2, 40 °C",
            "yield": "",
            "reactant_smiles": "CC(C)(C)OC(=O)NCC1(C)[C@H]2CC(=O)[C@@]3([C@H]([C@@H](CC1)O3)C=O)OC",
            "product_smiles": "CC12CC[C@@H]([C@H]3[C@@H]4CC(=O)C([C@@H](C1)O4)C3NC2)OC",
            "notes": "Boc deprotection and intramolecular cyclization between the amine and aldehyde to form a new cyclic amine-containing ring.",
            "substeps": []
        },
        {
            "step_id": "20",
            "reaction_type": "N-Alkylation",
            "reagents": "NaOH, EtI",
            "reagent_smiles": "",
            "conditions": "THF, H2O, 80 °C",
            "yield": "",
            "reactant_smiles": "C[C@]1(CCN2C[C@H]3[C@H]4C(=O)C[C@H]2[C@H]1[C@@H](OC)C34)",
            "product_smiles": "CCN1[C@H]2[C@](C)(CCN2C[C@H]3[C@H]4C(=O)C[C@H]2[C@H]1[C@@H](OC)C34)",
            "notes": "N-alkylation of a secondary amine using iodoethane and base.",
            "substeps": []
        },
        {
            "step_id": "21",
            "reaction_type": "Oxidation",
            "reagents": "NIS, NaHCO3",
            "reagent_smiles": "",
            "conditions": "THF, H2O, 35 °C",
            "yield": "81%",
            "reactant_smiles": "CCN1C2C(OC)C3C(=O)CC4C(C)(CCC23)C41",
            "product_smiles": "CCN1C(=O)C2(C)CCC3C(OC)C4C(=O)CC(C23)C41",
            "notes": "Oxidation of the alpha-methylene group adjacent to nitrogen to form a lactam (cyclic amide).",
            "substeps": []
        },
        {
            "step_id": "22",
            "reaction_type": "Ketone Homologation / Ring Expansion",
            "reagents": "TMSCHN2, n-BuLi",
            "reagent_smiles": "",
            "conditions": "THF, -78 °C",
            "yield": "91%",
            "reactant_smiles": "CCN1C2C3CC4C(C)(CCC(C42CC3=O)OC)C1=O",
            "product_smiles": "CCN1C2C3CC4C(C)(CCC(C42CCC3=O)OC)C1=O",
            "notes": "Homologation of a cyclic ketone via ring expansion using trimethylsilyldiazomethane (TMSCHN2) and n-butyllithium.",
            "substeps": []
        },
        {
            "step_id": "23",
            "reaction_type": "Oxidation",
            "reagents": "t-BuOK, O2",
            "reagent_smiles": "CC(C)(C)O[K].O=O",
            "conditions": "t-BuOH, THF",
            "yield": "",
            "reactant_smiles": "CCN1C2C3CC4C(C)(CCC(C42CCC3=O)OC)C1=O",
            "product_smiles": "CCN1C2C3CC4C(C)(CCC(C42C=C(C3=O)O)OC)C1=O",
            "notes": "Alpha-hydroxylation of a ketone",
            "substeps": []
        },
        {
            "step_id": "24",
            "reaction_type": "O-alkylation of enol",
            "reagents": "t-BuOH, THF",
            "reagent_smiles": "C=C(CBr)COCC1=CC=CC=C1",
            "conditions": "0 °C to rt",
            "yield": "51% (2 steps)",
            "reactant_smiles": "CCN1C2C3CC4C(C)(CCC(C42C=C(C3=O)O)OC)C1=O",
            "product_smiles": "CCN1C2C3CC4C(C)(CCC(C42C=C(C3=O)OCC(=C)COCC5=CC=CC=C5)OC)C1=O",
            "notes": "O-alkylation of an enol with a bromoalkene. The reactant's hydroxyl group is alkylated by the reagent. The product SMILES represents an open-chain ether, which is consistent with the atom count and reagent structure. However, the product in the screenshot visually depicts a new 6-membered cyclic ether fused to the core, which contradicts the open-chain SMILES. Given the strong match of the SMILES with an O-alkylation product's fragments and atom count, the SMILES is kept, and the visual discrepancy is noted.",
            "substeps": [
                {
                    "step_id": "24.1",
                    "reaction_type": "Williamson Ether Synthesis",
                    "reagents": "NaH, BnBr, TBAI",
                    "reagent_smiles": "",
                    "conditions": "THF, 0 °C to rt",
                    "yield": "69%",
                    "reactant_smiles": "C=C(CO)CO",
                    "product_smiles": "C=C(CO)C[OBn]",
                    "notes": "Monobenzylation of 2-(hydroxymethyl)prop-2-en-1-ol.",
                    "substeps": []
                },
                {
                    "step_id": "24.2",
                    "reaction_type": "Bromination (Appel reaction)",
                    "reagents": "CBr4, PPh3",
                    "reagent_smiles": "",
                    "conditions": "DCM, 0 °C",
                    "yield": "78%",
                    "reactant_smiles": "OCC(=C)C[OBn]",
                    "product_smiles": "BrCC(=C)C[OBn]",
                    "notes": "Conversion of a primary alcohol to a primary bromide using CBr4 and PPh3.",
                    "substeps": []
                }
            ]
        },
        {
            "step_id": "25",
            "reaction_type": "Grignard Addition / Reduction",
            "reagents": "",
            "reagent_smiles": "C=CC[Mg]Br",
            "conditions": "THF, -78 °C",
            "yield": "81%",
            "reactant_smiles": "CCN1C(=O)C2(C)C3CC4C(CCC5OC4C=C(OCC(=C)[OBn])C5=O)C3C21",
            "product_smiles": "CCN1C(=O)C2(C)C3CC4C(CCC5OC4C[C@@](O)(CC=C)C(OCC(=C)[OBn])C5)C3C21",
            "notes": "Allyl Grignard addition to an α,β-unsaturated lactone system, resulting in the reduction of the carbon-carbon double bond, conversion of the lactone carbonyl to a methylene group within the ring, and the stereoselective addition of an allyl group and a hydroxyl group to the original α-carbon.",
            "substeps": []
        },
        {
            "step_id": "26",
            "reaction_type": "Thermal Rearrangement",
            "reagents": "mesitylene",
            "reagent_smiles": "",
            "conditions": "200 °C",
            "yield": "",
            "reactant_smiles": "",
            "product_smiles": "",
            "notes": "A complex thermal rearrangement reaction involving multiple ring transformations. The reactant's enol ether side chain is transformed into a lactone, and a bridged ether oxygen rearranges to a methoxy group in the product. Stereochemistry is present in both reactant and product structures.",
            "substeps": []
        },
        {
            "step_id": "27",
            "reaction_type": "Ring-Closing Metathesis (RCM)",
            "reagents": "Grubbs II",
            "reagent_smiles": "",
            "conditions": "120 °C",
            "yield": "",
            "reactant_smiles": "C=CC[C@@]1(O)C2CC3C(C)(CCC(C3(C(OC(=O)C[OBn])C2N([Et])C(=O)C)OC)))O",
            "product_smiles": "[Et]N1C2C3CC4C(C)(CCC(C42C5CC(=CC[C@]3(C5=O)O)C[OBn])OC)C1=O",
            "notes": "Intramolecular ring-closing metathesis reaction where the allyl group and the CH2-OBn group, via the ester oxygen, form a new six-membered ring containing a double bond, catalyzed by Grubbs II catalyst at elevated temperature. The stereochemistry of the hydroxyl group is retained.",
            "substeps": []
        },
        {
            "step_id": "28",
            "reaction_type": "Hydrogenation / Reductive deprotection",
            "reagents": "Raney Ni, H2, Pd/C",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "85%",
            "reactant_smiles": "CCN1C(=O)C23C(C)C4CCC(OC)C4C3C5C6=C(C=C[C@@H](O)(C6=O)C5C[OBn])C21",
            "product_smiles": "CCN1C(=O)C23C(C)C4CCC(OC)C4C3C5C6CC[C@@H](O)(C6=O)C5[C@H](CO)C21",
            "notes": "Hydrogenation of the enone double bond and hydrogenolytic deprotection of the benzyl ether to a primary alcohol.",
            "substeps": []
        },
        {
            "step_id": "29",
            "reaction_type": "Oxidation",
            "reagents": "DMP, NaHCO3",
            "reagent_smiles": "",
            "conditions": "CH2Cl2, rt",
            "yield": "66%",
            "reactant_smiles": "CCN1C2C3CC4C(C)(CCC(C42C5C[C@H](CC[C@@]3(C5=O)O)CO)OC)C1=O",
            "product_smiles": "CCN1C2C3CC4C(C)(CCC(C42C5C[C@H](CC[C@@]3(C5=O)O)C=O)OC)C1=O",
            "notes": "Dess-Martin periodinane oxidation of a primary alcohol to an aldehyde.",
            "substeps": []
        },
        {
            "step_id": "30",
            "reaction_type": "Reductive Cyclization",
            "reagents": "SmI2",
            "reagent_smiles": "",
            "conditions": "THF",
            "yield": "73%",
            "reactant_smiles": "CC[N]1C(=O)C2(C)C3CC4C(OC)C5C(C[C@H](C=O)[C@@H]6CC[C@]7([C@H](C)C(C3)C47)C5C26)O",
            "product_smiles": "CC[N]1C(=O)C2(C)C3CC4C(O)C(CO)C5C(C[C@@H]6CC[C@]7([C@H](C)C(C3)C47)C5C26)O",
            "notes": "Aldehyde reduced to primary alcohol (CH2OH), and methyl ether converted to cyclic hemiacetal.",
            "substeps": []
        },
        {
            "step_id": "31",
            "reaction_type": "Reduction",
            "reagents": "LiAlH4",
            "reagent_smiles": "",
            "conditions": "THF, 70 °C",
            "yield": "85%",
            "reactant_smiles": "CCN1C2C3CC4C(C)(CCC(C42C5CC6CC[C@]3(C5(C6O)O)O)OC)C1=O",
            "product_smiles": "CCN1CC2(C)CCC(C34C5CC6CC[C@](C(CC23)C41)(C5C6O)O)OC",
            "notes": "Lactam reduction using lithium aluminum hydride (LiAlH4).",
            "substeps": []
        },
        {
            "step_id": "32",
            "reaction_type": "Oxidation",
            "reagents": "CrO3, H2SO4",
            "reagent_smiles": "",
            "conditions": "acetone",
            "yield": "78%",
            "reactant_smiles": "CCN1CC2(C)CCC(C34C5CC6CC[C@](C(CC23)C41)(C5C6O)O)OC",
            "product_smiles": "CCN1CC2(C)CCC(C34C5CC6CC[C@](C(CC23)C41)(C5C6=O)O)OC",
            "notes": "Oxidation of a secondary alcohol to a ketone using Jones reagent conditions.",
            "substeps": []
        },
        {
            "step_id": "33",
            "reaction_type": "Baeyer-Villiger Oxidation",
            "reagents": "H2O2, HCO2H",
            "reagent_smiles": "",
            "conditions": "",
            "yield": "77%",
            "reactant_smiles": "CCN1CC2(C)CCC(C34C5CC6CC[C@](C(CC23)C41)(C5C6=O)O)OC",
            "product_smiles": "CCN1CC2(C)CCC(C34C5CC6CC[C@](C(CC23)C41)(C5C(=O)O6)O)OC",
            "notes": "Baeyer-Villiger oxidation of a cyclic ketone to a lactone.",
            "substeps": []
        }
    ]
}